<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delivery Dashboard Demo</title>

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #1a1a1a;
            color: #f0f0f0;
            margin: 0;
            padding: 20px;
        }

        main {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #4a90e2;
        }

        .delivery-card {
            background-color: #2c2c2e;
            border: 1px solid #444;
            border-left: 5px solid #888; /* Default border color */
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        /* Card details on the left */
        .card-details {
            flex-grow: 1;
        }

        .card-details h3 {
            margin: 0 0 5px 0;
            color: #fff;
        }

        .card-details p {
            margin: 4px 0;
            color: #aaa;
            font-size: 0.9em;
        }

        /* Status dropdown on the right */
        .status-selector select {
            background-color: #3a3a3c;
            color: #f0f0f0;
            border: 1px solid #555;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 0.9em;
            cursor: pointer;
        }

        /* * --- DYNAMIC STATUS STYLES ---
         * This is how the UI reacts to the 'status' field
        */

        .delivery-card[data-status="Pending"] {
            border-left-color: #f5a623; /* Orange */
        }

        .delivery-card[data-status="Out for Delivery"] {
            border-left-color: #4a90e2; /* Blue */
            background-color: #303642;
        }

        .delivery-card[data-status="Delivered"] {
            border-left-color: #7ed321; /* Green */
            opacity: 0.7;
        }

        .delivery-card[data-status="Delivered"] h3,
        .delivery-card[data-status="Delivered"] p {
            text-decoration: line-through;
            color: #888;
        }

        .delivery-card[data-status="Failed"] {
            border-left-color: #d0021b; /* Red */
            opacity: 0.8;
        }
    </style>
</head>
<body>

    <main>
        <h1>Active Deliveries</h1>
        <div id="delivery-list-container">
            </div>
    </main>

    <script>
        // Wait for the HTML to be fully loaded before running the script
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. MOCK DATABASE ---
            // This array simulates the data from your 'w2119876_Delivery' table.
            // Notice it includes windowStart and windowEnd.
            const mockDeliveries = [
                {
                    deliveryID: 501,
                    orderID: 10234,
                    addressID: 300,
                    windowStart: '2025-10-21T14:00:00',
                    windowEnd: '2025-10-21T17:00:00',
                    status: 'Pending'
                },
                {
                    deliveryID: 502,
                    orderID: 10235,
                    addressID: 301,
                    windowStart: '2025-10-21T15:00:00',
                    windowEnd: '2025-10-21T18:00:00',
                    status: 'Out for Delivery'
                },
                {
                    deliveryID: 503,
                    orderID: 10236,
                    addressID: 302,
                    windowStart: '2025-10-20T10:00:00',
                    windowEnd: '2025-10-20T12:00:00',
                    status: 'Delivered'
                },
                {
                    deliveryID: 504,
                    orderID: 10237,
                    addressID: 303,
                    windowStart: '2025-10-20T16:00:00',
                    windowEnd: '2025-10-20T18:00:00',
                    status: 'Failed'
                }
            ];

            // --- 2. GET DOM ELEMENTS ---
            // This is the container where we'll put the delivery cards
            const listContainer = document.getElementById('delivery-list-container');

            // --- 3. RENDER FUNCTION ---
            // This function builds the HTML for each delivery
            function renderDeliveries() {
                // Clear the list before re-drawing
                listContainer.innerHTML = '';

                // Loop over each delivery in our mock database
                mockDeliveries.forEach(delivery => {
                    // Create a new <div> for the card
                    const card = document.createElement('div');
                    card.className = 'delivery-card';
                    // This 'data-status' attribute is used by the CSS to change the color
                    card.dataset.status = delivery.status;

                    // Helper function to format the time window
                    const windowTime = formatWindow(delivery.windowStart, delivery.windowEnd);

                    // This is the HTML structure for each card
                    card.innerHTML = `
                        <div class="card-details">
                            <h3>Order ID: #${delivery.orderID}</h3>
                            <p>Delivery Window: ${windowTime}</p>
                            <p>Database PK: ${delivery.deliveryID}</p>
                        </div>
                        <div class="status-selector">
                            <select class="status-dropdown" data-id="${delivery.deliveryID}">
                                <option value="Pending">Pending</option>
                                <option value="Out for Delivery">Out for Delivery</option>
                                <option value="Delivered">Delivered</option>
                                <option value="Failed">Failed</option>
                            </select>
                        </div>
                    `;

                    // --- 4. MAKE IT INTERACTIVE ---
                    
                    // Find the dropdown we just created inside the card
                    const statusDropdown = card.querySelector('.status-dropdown');
                    
                    // Set its current value to match the data
                    statusDropdown.value = delivery.status;
                    
                    // Add an event listener for when the user changes the value
                    statusDropdown.addEventListener('change', (event) => {
                        const newStatus = event.target.value;
                        const deliveryId = event.target.dataset.id;
                        
                        // Update the card's style in the UI
                        card.dataset.status = newStatus;

                        // Find the item in our mock database and update it
                        const itemToUpdate = mockDeliveries.find(d => d.deliveryID == deliveryId);
                        if (itemToUpdate) {
                            itemToUpdate.status = newStatus;
                        }

                        // --- THIS IS THE DEMO'S "DATABASE" CALL ---
                        // For your demo, you can open the console (F12) to see this message
                        console.log(`
                            --- SIMULATING DATABASE UPDATE ---
                            UPDATE w2119876_Delivery
                            SET w2119876_status = '${newStatus}'
                            WHERE w2119876_deliveryID = ${deliveryId};
                            ----------------------------------
                        `);
                    });

                    // Add the finished card to the page
                    listContainer.appendChild(card);
                });
            }

            // --- 5. HELPER FUNCTION ---
            // A small function to make the date/time look nice
            function formatWindow(startStr, endStr) {
                const options = { hour: 'numeric', minute: 'numeric', hour12: true };
                
                const start = new Date(startStr).toLocaleTimeString('en-US', options);
                const end = new Date(EndStr).toLocaleTimeString('en-US', options);
                
                return `${start} - ${end}`;
            }

            // --- 6. INITIALIZE ---
            // Call the render function once to build the page
            renderDeliveries();
        });
    </script>
</body>
</html>